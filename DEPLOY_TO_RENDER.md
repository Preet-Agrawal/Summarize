# Deploy Story Quiz to Render

## Quick Deploy with npm

```bash
# Build the project
npm run build

# The project is now ready for Render deployment!
```

## Steps to Deploy

### 1. Push your code to GitHub
```bash
git add .
git commit -m "Prepare for Render deployment"
git push origin main
```

### 2. Create a Render account
- Go to https://render.com and sign up (free tier available)

### 3. Create a new Web Service
- Click **"New +"** → **"Web Service"**
- Connect your GitHub repository
- Render will auto-detect the configuration from `render.yaml`

### 4. Configure Build Settings (auto-detected from render.yaml)
- **Build Command**: `npm run build`
- **Start Command**: `gunicorn app:app --bind 0.0.0.0:$PORT`
- **Environment**: Python 3

### 5. Set Environment Variables
In the Render dashboard, add these environment variables:

| Variable | Value | Required |
|----------|-------|----------|
| `MONGO_URI` | `mongodb+srv://username:password@cluster.mongodb.net/storyquiz` | ✅ Yes |
| `GROQ_API_KEY` | Your Groq API key | ✅ Yes |
| `SECRET_KEY` | Auto-generated by Render | ✅ Yes |
| `FLASK_ENV` | `production` | Optional |

### 6. Deploy
- Click **"Create Web Service"**
- Render will automatically build and deploy your app
- Monitor the deploy logs for progress
- Your app will be live at: `https://your-app-name.onrender.com`

## Files Configured for Deployment

- ✅ `package.json` - npm scripts including build command
- ✅ `requirements.txt` - Python dependencies
- ✅ `render.yaml` - Render configuration
- ✅ `build.sh` - Build script
- ✅ `render-build.sh` - Render-specific build script
- ✅ `Procfile` - Process configuration
- ✅ `app.py` - Flask application
- ✅ `.env.example` - Environment variables template
- ✅ `gunicorn` - Production WSGI server (in requirements.txt)

## npm Commands for Deployment

```bash
# Build for production
npm run build

# Check if build was successful
npm run build:check

# Run production server locally
npm run start:production
```

## Local Testing with Production Settings

```bash
# Install dependencies
npm install
pip install -r requirements.txt

# Test with Gunicorn
gunicorn app:app --bind 0.0.0.0:5000

# Or use npm
npm run start:production
```

## MongoDB Setup for Render

1. Create a MongoDB Atlas account (free tier)
2. Create a cluster
3. Add database user
4. Whitelist all IPs: `0.0.0.0/0`
5. Get connection string
6. Add to Render environment variables

## Troubleshooting

### Build Failed
- Check build logs in Render dashboard
- Verify `requirements.txt` has all dependencies
- Run `npm run build` locally to test

### App Crashes
- Check runtime logs
- Verify MongoDB connection string
- Ensure all environment variables are set
- Check Groq API key is valid

### 502 Bad Gateway
- App may be starting up (wait 30 seconds)
- Check start command uses `$PORT`
- Verify Gunicorn is installed

## Important Notes

- **Free Tier**: Services sleep after 15 minutes of inactivity
- **First Request**: May take ~30 seconds after sleep
- **MongoDB**: Ensure connection string includes database name
- **API Keys**: Keep them secret, never commit to Git
- **Logs**: Available in Render dashboard for debugging

## Support

- Render Docs: https://render.com/docs
- Project Issues: GitHub repository
- MongoDB Atlas: https://docs.atlas.mongodb.com